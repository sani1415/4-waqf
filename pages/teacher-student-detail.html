<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Details - Task Manager</title>
    <script src="../js/i18n.js"></script>
    <link rel="stylesheet" href="../css/common.css">
    <link rel="stylesheet" href="../css/teacher.css">
    <link rel="stylesheet" href="../css/teacher-student-detail.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="teacher-page">
    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <i class="fas fa-graduation-cap"></i>
            <h2 data-i18n="task_manager">Task Manager</h2>
        </div>
        
        <nav class="sidebar-nav">
            <a href="/pages/teacher-dashboard.html" class="nav-item">
                <i class="fas fa-home"></i>
                <span data-i18n="nav_dashboard">Dashboard</span>
            </a>
            <a href="/pages/teacher-dashboard.html#manage-tasks" class="nav-item">
                <i class="fas fa-tasks"></i>
                <span data-i18n="nav_manage_tasks">Manage Tasks</span>
            </a>
            <a href="/pages/teacher-dashboard.html#students" class="nav-item active">
                <i class="fas fa-users"></i>
                <span data-i18n="nav_students">Students</span>
            </a>
            <a href="/pages/teacher-daily-overview.html" class="nav-item">
                <i class="fas fa-table"></i>
                <span data-i18n="nav_daily_overview">Daily Tasks Overview</span>
            </a>
            <a href="/pages/teacher-exams.html" class="nav-item">
                <i class="fas fa-graduation-cap"></i>
                <span data-i18n="nav_exams">Exams</span>
            </a>
            <a href="/pages/teacher-messages.html" class="nav-item">
                <i class="fas fa-comments"></i>
                <span data-i18n="nav_messages">Messages</span>
            </a>
            <a href="/pages/teacher-dashboard.html#analytics" class="nav-item">
                <i class="fas fa-chart-bar"></i>
                <span data-i18n="nav_analytics">Analytics</span>
            </a>
        </nav>

        <div class="sidebar-footer">
            <a href="/index.html" class="nav-item">
                <i class="fas fa-arrow-left"></i>
                <span data-i18n="nav_back_home">Back to Home</span>
            </a>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <header class="top-bar">
            <button class="menu-toggle" id="menuToggle">
                <i class="fas fa-bars"></i>
            </button>
            <div class="breadcrumb">
                <a href="/pages/teacher-dashboard.html" data-i18n="nav_dashboard">Dashboard</a>
                <i class="fas fa-chevron-right"></i>
                <span data-i18n="student_details">Student Details</span>
            </div>
            <div class="top-bar-right">
                <div class="lang-switcher lang-switcher-compact" aria-label="Language">
                    <button type="button" class="lang-btn" data-lang="en" onclick="setLang('en')" title="English">EN</button>
                    <button type="button" class="lang-btn" data-lang="bn" onclick="setLang('bn')" title="‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ">‡¶¨‡¶æ‡¶Ç</button>
                </div>
                <div class="user-info">
                    <i class="fas fa-user-circle"></i>
                    <span data-i18n="teacher">Teacher</span>
                </div>
            </div>
        </header>

        <div class="detail-container">
            <!-- Student Profile Card -->
            <div class="student-detail-header">
                <div class="student-profile-card">
                    <div class="profile-avatar-large" id="studentAvatar">A</div>
                    <div class="profile-info">
                        <h1 id="studentName">Student Name</h1>
                        <p id="studentEmail">student@example.com</p>
                    </div>
                </div>
                <div class="action-buttons">
                    <button class="btn-secondary" onclick="goBack()">
                        <i class="fas fa-arrow-left"></i> <span data-i18n="back">Back</span>
                    </button>
                    <button class="btn-primary" onclick="showEditStudentModal()">
                        <i class="fas fa-edit"></i> <span data-i18n="edit_profile">Edit Profile</span>
                    </button>
                    <button class="btn-primary" onclick="assignNewTask()">
                        <i class="fas fa-plus"></i> <span data-i18n="assign_task">Assign Task</span>
                    </button>
                </div>
            </div>

            <!-- Student Profile Info Section -->
            <div class="student-profile-info-section">
                <h3 class="profile-section-title">
                    <i class="fas fa-user-circle"></i> <span data-i18n="student_information">Student Information</span>
                </h3>
                <div class="profile-info-grid">
                    <!-- Basic Information -->
                    <div class="info-card">
                        <h4><i class="fas fa-id-card"></i> <span data-i18n="basic_details">Basic Details</span></h4>
                        <div class="info-row">
                            <span class="info-label" data-i18n="student_id">Student ID:</span>
                            <span class="info-value" id="profileStudentId">-</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label" data-i18n="date_of_birth">Date of Birth:</span>
                            <span class="info-value" id="profileDateOfBirth">-</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label" data-i18n="grade">Grade:</span>
                            <span class="info-value" id="profileGrade">-</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label" data-i18n="section">Section:</span>
                            <span class="info-value" id="profileSection">-</span>
                        </div>
                    </div>

                    <!-- Contact Information -->
                    <div class="info-card">
                        <h4><i class="fas fa-address-book"></i> <span data-i18n="contact_details">Contact Details</span></h4>
                        <div class="info-row">
                            <span class="info-label" data-i18n="phone">Phone:</span>
                            <span class="info-value" id="profilePhone">-</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label" data-i18n="email">Email:</span>
                            <span class="info-value" id="profileEmail">-</span>
                        </div>
                    </div>

                    <!-- Parent Information -->
                    <div class="info-card">
                        <h4><i class="fas fa-users"></i> <span data-i18n="parent_guardian_info">Parent/Guardian</span></h4>
                        <div class="info-row">
                            <span class="info-label" data-i18n="name">Name:</span>
                            <span class="info-value" id="profileParentName">-</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label" data-i18n="phone">Phone:</span>
                            <span class="info-value" id="profileParentPhone">-</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label" data-i18n="email">Email:</span>
                            <span class="info-value" id="profileParentEmail">-</span>
                        </div>
                    </div>

                    <!-- Enrollment Information -->
                    <div class="info-card">
                        <h4><i class="fas fa-calendar-check"></i> <span data-i18n="enrollment_details">Enrollment</span></h4>
                        <div class="info-row">
                            <span class="info-label" data-i18n="enrolled">Enrolled:</span>
                            <span class="info-value" id="profileEnrollmentDate">-</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label" data-i18n="member_since">Member Since:</span>
                            <span class="info-value" id="profileMemberSince">-</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Compact Dual Progress Section -->
            <div class="compact-progress-section">
                <!-- Daily Progress -->
                <div class="compact-progress-card daily-card">
                    <div class="compact-progress-header">
                        <i class="fas fa-calendar-day"></i>
                        <span data-i18n="tab_daily">Daily Tasks</span>
                        <span class="compact-percentage" id="dailyPercentageCompact">0%</span>
                    </div>
                    <div class="compact-progress-bar">
                        <div class="compact-progress-fill daily-fill" id="dailyProgressCompact" style="width: 0%"></div>
                    </div>
                    <div class="compact-stats-row">
                        <span><i class="fas fa-check"></i> <strong id="dailyCompletedCompact">0</strong>/<span id="dailyTotalCompact">0</span></span>
                        <span class="stat-label" data-i18n="todays_completion">Today's completion</span>
                    </div>
                </div>

                <!-- One-time Progress -->
                <div class="compact-progress-card onetime-card">
                    <div class="compact-progress-header">
                        <i class="fas fa-tasks"></i>
                        <span data-i18n="category_onetime">One-time Tasks</span>
                        <span class="compact-percentage" id="onetimePercentageCompact">0%</span>
                    </div>
                    <div class="compact-progress-bar">
                        <div class="compact-progress-fill onetime-fill" id="onetimeProgressCompact" style="width: 0%"></div>
                    </div>
                    <div class="compact-stats-row">
                        <span><i class="fas fa-check-double"></i> <strong id="onetimeCompletedCompact">0</strong>/<span id="onetimeTotalCompact">0</span></span>
                        <span class="stat-label" data-i18n="overall_completion">Overall completion</span>
                    </div>
                </div>

                <!-- Quiz Progress -->
                <div class="compact-progress-card quiz-card">
                    <div class="compact-progress-header">
                        <i class="fas fa-graduation-cap"></i>
                        <span data-i18n="quizzes">Quizzes</span>
                        <span class="compact-percentage" id="quizPercentageCompact">0%</span>
                    </div>
                    <div class="compact-progress-bar">
                        <div class="compact-progress-fill quiz-fill" id="quizProgressCompact" style="width: 0%"></div>
                    </div>
                    <div class="compact-stats-row">
                        <span><i class="fas fa-trophy"></i> <strong id="quizPassedCompact">0</strong>/<span id="quizTotalCompact">0</span></span>
                        <span class="stat-label" data-i18n="passed_quizzes">Passed quizzes</span>
                    </div>
                </div>
            </div>

            <!-- Compact Tab Navigation -->
            <div class="compact-tab-navigation">
                <button class="compact-tab-btn active" id="todayTabTeacher" onclick="switchTabTeacher('today')">
                    <i class="fas fa-calendar-day"></i> <span data-i18n="todays_daily_tasks">Today's Daily Tasks</span>
                </button>
                <button class="compact-tab-btn" id="allTasksTabTeacher" onclick="switchTabTeacher('allTasks')">
                    <i class="fas fa-clipboard-list"></i> <span data-i18n="all_onetime_tasks">All One-time Tasks</span>
                </button>
            </div>

            <!-- Tasks Sections -->
            <div class="tasks-detailed-view">
                <!-- Today Tab - Daily Tasks -->
                <div class="tab-content-teacher active" id="todayTabContentTeacher">
                    <div class="task-section-detailed">
                        <div class="section-header-detailed">
                            <h2>
                                <i class="fas fa-calendar-day"></i>
                                <span data-i18n="todays_daily_tasks">Today's Daily Tasks</span>
                            </h2>
                            <span class="task-count" id="dailyTasksCountBadge">0 <span data-i18n="tasks_count">tasks</span></span>
                        </div>
                        <div id="dailyTasksList" class="tasks-grid-detailed">
                            <!-- Daily tasks will be loaded here -->
                        </div>
                    </div>
                </div>

                <!-- All Tasks Tab - One-time Tasks -->
                <div class="tab-content-teacher" id="allTasksTabContentTeacher">
                    <!-- Pending Tasks -->
                    <div class="task-section-detailed">
                        <div class="section-header-detailed">
                            <h2>
                                <i class="fas fa-clipboard-list"></i>
                                <span data-i18n="stat_pending_tasks">Pending Tasks</span>
                            </h2>
                            <span class="task-count" id="pendingCountBadge">0 <span data-i18n="tasks_count">tasks</span></span>
                        </div>
                        <div id="pendingTasksList" class="tasks-grid-detailed">
                            <!-- Pending tasks will be loaded here -->
                        </div>
                    </div>

                    <!-- Completed Tasks -->
                    <div class="task-section-detailed" style="margin-top: 2rem;">
                        <div class="section-header-detailed">
                            <h2>
                                <i class="fas fa-check-double"></i>
                                <span data-i18n="stat_completed_tasks">Completed Tasks</span>
                            </h2>
                            <span class="task-count success" id="completedCountBadge">0 <span data-i18n="tasks_count">tasks</span></span>
                        </div>
                        <div id="completedTasksList" class="tasks-grid-detailed">
                            <!-- Completed tasks will be loaded here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Teacher Notes Section -->
            <div class="teacher-notes-section">
                <div class="notes-header">
                    <h3 class="notes-title">
                        <i class="fas fa-clipboard"></i> <span data-i18n="teacher_notes_analysis">Teacher Notes & Analysis</span>
                    </h3>
                    <button class="btn-primary" onclick="showAddNoteModal()">
                        <i class="fas fa-plus"></i> <span data-i18n="add_note">Add Note</span>
                    </button>
                </div>
                <div id="notesList" class="notes-container">
                    <!-- Notes will be dynamically loaded here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Add Note Modal -->
    <div id="addNoteModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeAddNoteModal()">&times;</span>
            <h2><i class="fas fa-sticky-note"></i> <span data-i18n="add_new_note">Add New Note</span></h2>
            <form id="addNoteForm">
                <div class="form-group">
                    <label for="noteCategory"><span data-i18n="category">Category</span> <span class="required" data-i18n="required">*</span></label>
                    <select id="noteCategory" required>
                        <option value="" data-i18n="select_category">Select Category</option>
                        <option value="Academic">üìö Academic</option>
                        <option value="Behavioral">üòä Behavioral</option>
                        <option value="General">üìù General</option>
                        <option value="Parent Communication">üë™ Parent Communication</option>
                        <option value="Achievement">üèÜ Achievement</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="noteText"><span data-i18n="note">Note</span> <span class="required" data-i18n="required">*</span></label>
                    <textarea id="noteText" rows="5" required data-i18n-placeholder="placeholder_note_text" placeholder="Write your note or analysis here..."></textarea>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-secondary" onclick="closeAddNoteModal()">
                        <i class="fas fa-times"></i> <span data-i18n="btn_cancel">Cancel</span>
                    </button>
                    <button type="submit" class="btn-primary">
                        <i class="fas fa-save"></i> <span data-i18n="add_note">Add Note</span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Edit Note Modal -->
    <div id="editNoteModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeEditNoteModal()">&times;</span>
            <h2><i class="fas fa-edit"></i> <span data-i18n="edit_note">Edit Note</span></h2>
            <form id="editNoteForm">
                <input type="hidden" id="editNoteId">
                <div class="form-group">
                    <label for="editNoteCategory"><span data-i18n="category">Category</span> <span class="required" data-i18n="required">*</span></label>
                    <select id="editNoteCategory" required>
                        <option value="" data-i18n="select_category">Select Category</option>
                        <option value="Academic">üìö Academic</option>
                        <option value="Behavioral">üòä Behavioral</option>
                        <option value="General">üìù General</option>
                        <option value="Parent Communication">üë™ Parent Communication</option>
                        <option value="Achievement">üèÜ Achievement</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="editNoteText">Note <span class="required">*</span></label>
                    <textarea id="editNoteText" rows="5" required placeholder="Write your note or analysis here..."></textarea>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-secondary" onclick="closeEditNoteModal()">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                    <button type="submit" class="btn-primary">
                        <i class="fas fa-save"></i> Save Changes
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Edit Student Modal -->
    <div id="editStudentModal" class="modal">
        <div class="modal-content modal-large">
            <span class="close" onclick="closeEditStudentModal()">&times;</span>
            <h2><i class="fas fa-user-edit"></i> Edit Student Profile</h2>
            <form id="editStudentForm" class="comprehensive-form">
                
                <!-- Section 1: Basic Information -->
                <div class="form-section">
                    <h3 class="section-header"><i class="fas fa-id-card"></i> Basic Information</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="editStudentName">Student Name <span class="required">*</span></label>
                            <input type="text" id="editStudentName" required placeholder="Full Name">
                        </div>
                        <div class="form-group">
                            <label for="editStudentId">Student ID <span class="required">*</span></label>
                            <input type="text" id="editStudentId" required placeholder="STU-2024-XXX">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="editDateOfBirth">Date of Birth <span class="required">*</span></label>
                            <input type="date" id="editDateOfBirth" required>
                        </div>
                        <div class="form-group">
                            <label for="editGrade">Grade <span class="required">*</span></label>
                            <select id="editGrade" required>
                                <option value="">Select Grade</option>
                                <option value="1st Grade">1st Grade</option>
                                <option value="2nd Grade">2nd Grade</option>
                                <option value="3rd Grade">3rd Grade</option>
                                <option value="4th Grade">4th Grade</option>
                                <option value="5th Grade">5th Grade</option>
                                <option value="6th Grade">6th Grade</option>
                                <option value="7th Grade">7th Grade</option>
                                <option value="8th Grade">8th Grade</option>
                                <option value="9th Grade">9th Grade</option>
                                <option value="10th Grade">10th Grade</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="editSection">Section <span class="required">*</span></label>
                            <select id="editSection" required>
                                <option value="">Select Section</option>
                                <option value="A">Section A</option>
                                <option value="B">Section B</option>
                                <option value="C">Section C</option>
                                <option value="D">Section D</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Section 2: Contact Information -->
                <div class="form-section">
                    <h3 class="section-header"><i class="fas fa-address-book"></i> Contact Information</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="editStudentPhone">Student Phone</label>
                            <input type="tel" id="editStudentPhone" placeholder="+1234567890">
                        </div>
                        <div class="form-group">
                            <label for="editStudentEmail">Student Email</label>
                            <input type="email" id="editStudentEmail" placeholder="student@example.com">
                        </div>
                    </div>
                </div>

                <!-- Section 3: Parent/Guardian Information -->
                <div class="form-section">
                    <h3 class="section-header"><i class="fas fa-users"></i> Parent/Guardian Information</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="editParentName">Parent/Guardian Name <span class="required">*</span></label>
                            <input type="text" id="editParentName" required placeholder="Full Name">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="editParentPhone">Parent Phone <span class="required">*</span></label>
                            <input type="tel" id="editParentPhone" required placeholder="+1234567890">
                        </div>
                        <div class="form-group">
                            <label for="editParentEmail">Parent Email</label>
                            <input type="email" id="editParentEmail" placeholder="parent@example.com">
                        </div>
                    </div>
                </div>

                <!-- Section 4: Enrollment Details -->
                <div class="form-section">
                    <h3 class="section-header"><i class="fas fa-calendar-check"></i> Enrollment Details</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="editEnrollmentDate">Enrollment Date <span class="required">*</span></label>
                            <input type="date" id="editEnrollmentDate" required>
                        </div>
                    </div>
                </div>

                <!-- Form Actions -->
                <div class="form-actions">
                    <button type="button" class="btn-secondary" onclick="closeEditStudentModal()">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                    <button type="submit" class="btn-primary">
                        <i class="fas fa-save"></i> Save Changes
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Mobile Bottom Navigation -->
    <nav class="bottom-nav" id="bottomNav" aria-label="Main navigation">
        <a href="/pages/teacher-dashboard.html" class="bottom-nav-item" title="Dashboard">
            <i class="fas fa-home"></i>
            <span>Dashboard</span>
        </a>
        <a href="/pages/teacher-dashboard.html#manage-tasks" class="bottom-nav-item" title="Tasks">
            <i class="fas fa-tasks"></i>
            <span>Tasks</span>
        </a>
        <a href="/pages/teacher-dashboard.html#students" class="bottom-nav-item active" title="Students">
            <i class="fas fa-users"></i>
            <span>Students</span>
        </a>
        <a href="/pages/teacher-messages.html" class="bottom-nav-item" title="Messages">
            <i class="fas fa-comments"></i>
            <span>Messages</span>
        </a>
        <a href="#" class="bottom-nav-item bottom-nav-menu" id="bottomNavMenu" title="Menu">
            <i class="fas fa-ellipsis-v"></i>
            <span>Menu</span>
        </a>
    </nav>

    <!-- Firebase SDK (Uncomment when using Firebase) -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    
    <!-- Storage Adapters (in separate folder) -->
    <script src="../js/storage/adapter.js"></script>
    <script src="../js/storage/localStorage.js"></script>
    <script src="../js/storage/firebase.js"></script>
    <script src="../js/storage/firebase-config.js"></script>
    <script src="../js/storage/config.js"></script>
    
    <!-- Data Manager & App Logic -->
    <script src="../js/data-manager.js"></script>
    <script src="../js/teacher-student-detail.js"></script>
</body>
</html>

